<!DOCTYPE html><html lang="en"><head><title>Public/js/src/base</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="Public/js/src/base"><meta name="groc-project-path" content="Resources/Public/js/src/base.coffee"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">Resources/Public/js/src/base.coffee</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="base-a-collection-of-helpers">base: A collection of helpers</h1>

<p>It's an old file which should be rewritten and splitted into several files</p></div></div><div class="code"><div class="wrapper"><span class="nx">$</span> <span class="o">-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="gethash">getHash</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="nv">$.getHash = </span><span class="nf">(url) -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Return the HashTag of the given url : parameter or current</p></div></div><div class="code"><div class="wrapper">    <span class="p">(</span><span class="k">if</span> <span class="nx">url</span> <span class="k">then</span> <span class="nx">url</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;</span><span class="err">#</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="placeholder">placeholder</h2>

<p>Must only be called only for browser not supporting placeholder attribute</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><pre><code class="javascript">unless Modernizr.input.placeholder
  $("input").each -&gt;
    $(this).placeholder() unless $(this).attr("placeholder") is ""
</code></pre></div></div><div class="code"><div class="wrapper">  <span class="nv">$.fn.placeholder = </span><span class="o">-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="initialize">Initialize</h3>

<p>Store placeholder value and fill the input</p></div></div><div class="code"><div class="wrapper">    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;placeholder&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;placeholder&quot;</span><span class="p">))</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">jQuery</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;placeholder&quot;</span><span class="p">))</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="emptyme">emptyMe()</h3>

<p>Empty the previous value on focus</p></div></div><div class="code"><div class="wrapper">    <span class="nv">emptyMe = </span><span class="o">-&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span> <span class="s">&quot;placeholder&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span> <span class="s">&quot;&quot;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="fullme">fullMe()</h3>

<p>Reset the value if nothing is found in the input on blur</p></div></div><div class="code"><div class="wrapper">    <span class="nv">fullMe = </span><span class="o">-&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;placeholder&quot;</span><span class="p">))</span>  <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">is</span> <span class="s">&quot;&quot;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="bind-events">Bind events</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;focus&quot;</span><span class="p">,</span> <span class="nx">emptyMe</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;blur&quot;</span><span class="p">,</span> <span class="nx">fullMe</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="hoversrc">hoverSrc</h2>

<p>Emulate a hover state for images</p></div></div><div class="code"><div class="wrapper">  <span class="nv">$.fn.hoverSrc = </span><span class="nf">(on_, off_) -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="initialize">Initialize</h3>

<p>Use hover / off suffixes or those given</p></div></div><div class="code"><div class="wrapper">    <span class="nv">suffixeOn = </span><span class="p">(</span><span class="k">if</span> <span class="nx">on_</span> <span class="k">then</span> <span class="nx">on_</span> <span class="k">else</span> <span class="s">&quot;-hover&quot;</span><span class="p">)</span>
    <span class="nv">suffixeOff = </span><span class="p">(</span><span class="k">if</span> <span class="nx">off_</span> <span class="k">then</span> <span class="nx">off_</span> <span class="k">else</span> <span class="s">&quot;-off&quot;</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="hoverin">hoverIn()</h3>

<p>Add the on suffixe to the image name</p></div></div><div class="code"><div class="wrapper">    <span class="nv">hoverIn = </span><span class="o">-&gt;</span>
      <span class="nx">unless</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s">&quot;active&quot;</span><span class="p">)</span>
        <span class="nv">srcName = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">)</span>
        <span class="nv">srcName = </span><span class="nx">srcName</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">suffixeOff</span><span class="p">,</span> <span class="nx">suffixeOn</span><span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span> <span class="nv">src: </span><span class="nx">srcName</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="hoverout">hoverOut()</h3>

<p>Add the off suffixe to the image name</p></div></div><div class="code"><div class="wrapper">    <span class="nv">hoverOut = </span><span class="o">-&gt;</span>
      <span class="nx">unless</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s">&quot;active&quot;</span><span class="p">)</span>
        <span class="nv">srcName = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">)</span>
        <span class="nv">srcName = </span><span class="nx">srcName</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">suffixeOn</span><span class="p">,</span> <span class="nx">suffixeOff</span><span class="p">)</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span> <span class="nv">src: </span><span class="nx">srcName</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Bind events</p></div></div><div class="code"><div class="wrapper">    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">each</span> <span class="o">-&gt;</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;focus mouseenter&quot;</span><span class="p">,</span> <span class="nx">hoverIn</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">bind</span> <span class="s">&quot;blur mouseleave&quot;</span><span class="p">,</span> <span class="nx">hoverOut</span>
      <span class="p">(</span><span class="k">new</span> <span class="nx">Image</span><span class="p">()).</span><span class="nv">src = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s">&quot;-off&quot;</span><span class="p">,</span> <span class="s">&quot;-hover&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="fixtotop">fixToTop</h2>

<p>Fix any element to the top when scroll pass it
&amp; add optionnal class for each step defined</p></div></div><div class="code"><div class="wrapper">  <span class="nv">$.fn.fixToTop = </span><span class="nf">(gap, steps) -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="initialize">Initialize</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nv">$that = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="nv">origin = </span><span class="p">(</span><span class="k">if</span> <span class="nx">gap</span> <span class="k">then</span> <span class="nx">$that</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetTop</span> <span class="o">+</span> <span class="nx">gap</span> <span class="k">else</span> <span class="nx">$that</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetTop</span><span class="p">)</span>
    <span class="nv">originOffSet = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">$that</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;marginTop&quot;</span><span class="p">))</span>
    <span class="nv">offSet = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">$that</span><span class="p">.</span><span class="nx">height</span><span class="p">())</span> <span class="o">+</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">$that</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;marginTop&quot;</span><span class="p">))</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If steps option is found, listen to scroll to set classes for each step</p>

<pre><code class="JavaScript">steps:
  "className": offsetValue
</code></pre></div></div><div class="code"><div class="wrapper">    <span class="k">if</span> <span class="nx">steps</span>
      <span class="nv">stepsClasses = </span><span class="s">&quot;&quot;</span>
      <span class="k">for</span> <span class="nx">step</span> <span class="k">of</span> <span class="nx">steps</span>
        <span class="nx">stepsClasses</span> <span class="o">+=</span> <span class="s">&#39; &#39;</span><span class="o">+</span><span class="nx">step</span>
      <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scroll</span> <span class="o">-&gt;</span>
        <span class="k">for</span> <span class="nx">step</span> <span class="k">of</span> <span class="nx">steps</span>
          <span class="k">if</span> <span class="nx">$that</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;visibility&quot;</span><span class="p">)</span> <span class="o">isnt</span> <span class="s">&quot;hidden&quot;</span> <span class="o">and</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">steps</span><span class="p">[</span><span class="nx">step</span><span class="p">]</span>
            <span class="nx">$that</span>
              <span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">stepsClasses</span><span class="p">)</span>
              <span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">step</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="bind-to-scroll-event">Bind to scroll event</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scroll</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="nx">$that</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;visibility&quot;</span><span class="p">)</span> <span class="o">isnt</span> <span class="s">&quot;hidden&quot;</span> <span class="o">and</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">origin</span>
        <span class="nx">fix</span><span class="p">()</span>
      <span class="k">else</span>
        <span class="nx">free</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="fix">fix()</h3>

<p>Add the class fixed to the element to handle the position from css
and handle an optionnal offset</p></div></div><div class="code"><div class="wrapper">    <span class="nv">fix = </span><span class="o">-&gt;</span>
      <span class="nx">unless</span> <span class="nx">$that</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s">&quot;fixed&quot;</span><span class="p">)</span>
        <span class="nv">offSet = </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">$that</span><span class="p">.</span><span class="nx">height</span><span class="p">())</span> <span class="o">+</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">$that</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">css</span><span class="p">(</span><span class="s">&quot;marginTop&quot;</span><span class="p">))</span>
        <span class="nx">$that</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&quot;fixed&quot;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Set margin to balance the fixed position</p></div></div><div class="code"><div class="wrapper">        <span class="nx">$that</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">css</span> <span class="s">&quot;marginTop&quot;</span><span class="p">,</span> <span class="nx">offSet</span> <span class="o">+</span> <span class="s">&quot;px&quot;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="free">free()</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nv">free = </span><span class="o">-&gt;</span>
      <span class="nx">$that</span><span class="p">.</span><span class="nx">removeClass</span> <span class="s">&quot;fixed&quot;</span>
      <span class="nx">$that</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">css</span> <span class="s">&quot;marginTop&quot;</span><span class="p">,</span> <span class="nx">originOffSet</span> <span class="o">+</span> <span class="s">&quot;px&quot;</span>

    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="pulldown">Pulldown</h2>

<p>Show/Hide content of pulldown element on click on the first child (button) of each elements
Use css to do the toggle.</p></div></div><div class="code"><div class="wrapper">  <span class="nv">$.fn.pulldown = </span><span class="o">-&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="initialize">Initialize</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nv">$list = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="nv">$items = </span><span class="nx">$list</span><span class="p">.</span><span class="nx">children</span><span class="p">()</span>
    <span class="nv">$buttons = </span><span class="nx">$items</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&quot;&gt; *:first-child&quot;</span><span class="p">)</span>
    <span class="nx">$items</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&quot;close&quot;</span>
    <span class="nx">$buttons</span><span class="p">.</span><span class="nx">addClass</span> <span class="s">&quot;pulldownButton&quot;</span>
    <span class="nx">$buttons</span><span class="p">.</span><span class="nx">unbind</span> <span class="s">&quot; click&quot;</span>
    <span class="nx">$buttons</span><span class="p">.</span><span class="nx">bind</span> <span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="nf">(e) -&gt;</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Add class to hide non-button elements</p></div></div><div class="code"><div class="wrapper">    <span class="nx">$items</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="o">not</span><span class="p">(</span><span class="nx">$buttons</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&quot;pulldownContent&quot;</span>
    <span class="nx">$items</span><span class="p">.</span><span class="nx">data</span> <span class="s">&quot;state&quot;</span><span class="p">,</span> <span class="mi">0</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="bind-click-events">Bind click events</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nx">$items</span><span class="p">.</span><span class="kc">on</span> <span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="nf">(e) -&gt;</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
      <span class="nv">$item = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">$item</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Close</p></div></div><div class="code"><div class="wrapper">        <span class="nx">$item</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&quot;close&quot;</span>
      <span class="k">else</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Open</p></div></div><div class="code"><div class="wrapper">        <span class="nx">$item</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nx">removeClass</span> <span class="s">&quot;close&quot;</span>
        <span class="nx">$items</span><span class="p">.</span><span class="o">not</span><span class="p">(</span><span class="nx">$item</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;state&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><span class="nx">addClass</span> <span class="s">&quot;close&quot;</span>

    <span class="nx">$list</span><span class="p">.</span><span class="nx">data</span> <span class="s">&quot;pulldown&quot;</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="backtotop">backToTop</h2>

<p>Display / hide a <em>back to top</em> button when scrolling under the gap</p></div></div><div class="code"><div class="wrapper">  <span class="nv">$.fn.backToTop = </span><span class="nf">(gap) -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="initialize">Initialize</h3></div></div></div><div class="segment"><div class="code"><div class="wrapper">    <span class="nv">$that = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
    <span class="nv">gap = </span><span class="p">(</span><span class="k">if</span> <span class="nx">gap</span> <span class="k">then</span> <span class="nx">gap</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kc">off</span> <span class="s">&quot;click&quot;</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="nf">(e) -&gt;</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">).</span><span class="nx">scrollTo</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nv">duration: </span><span class="mi">800</span>

    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kc">off</span> <span class="s">&quot;backToTop.scroll&quot;</span>
    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;backToTop.scroll&quot;</span><span class="p">,</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">gap</span>
        <span class="nx">$that</span><span class="p">.</span><span class="nx">fadeIn</span><span class="p">()</span>
      <span class="k">else</span>
        <span class="nx">$that</span><span class="p">.</span><span class="nx">fadeOut</span><span class="p">()</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If backToTop isn't initiated we trigger a scroll event on the element</p></div></div><div class="code"><div class="wrapper">    <span class="nx">unless</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s">&quot;backToTop&quot;</span><span class="p">)</span>
      <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scroll</span> <span class="o">-&gt;</span>
        <span class="nx">$that</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&quot;backToTop.scroll&quot;</span>

    <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span> <span class="s">&quot;backToTop&quot;</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="smoothanchors">smoothAnchors</h2>

<p>Add an automatic smooth Scroll to the section menu of typo3 or any child link matching <em>* a[href</em>="#c"] **</p></div></div><div class="code"><div class="wrapper">  <span class="nv">$.fn.smoothAnchors = </span><span class="nf">(offsetTop, screenOffset) -&gt;</span>
    <span class="nv">$anchors = </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s">&quot;a[href*=\&quot;</span><span class="err">#</span><span class="s">c\&quot;]&quot;</span><span class="p">)</span>
    <span class="nv">anchorsOffsets = </span><span class="p">[]</span>
    <span class="nv">offsetTop = </span><span class="p">(</span><span class="k">if</span> <span class="nx">offsetTop</span> <span class="k">then</span> <span class="nx">offsetTop</span> <span class="k">else</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nv">screenOffset = </span><span class="p">(</span><span class="k">if</span> <span class="nx">screenOffset</span> <span class="k">then</span> <span class="nx">screenOffset</span> <span class="k">else</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>
    <span class="nx">$anchors</span><span class="p">.</span><span class="nx">each</span> <span class="o">-&gt;</span>
      <span class="nx">anchorsOffsets</span><span class="p">.</span><span class="nx">push</span> <span class="nx">$</span><span class="p">((</span><span class="s">&quot;</span><span class="err">#</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">getHash</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;href&quot;</span><span class="p">)))).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span>

    <span class="nv">anchorsOffsetsLength = </span><span class="nx">anchorsOffsets</span><span class="p">.</span><span class="nx">length</span>
    <span class="nx">$anchors</span><span class="p">.</span><span class="nx">unbind</span> <span class="s">&quot;click&quot;</span>
    <span class="nx">$anchors</span><span class="p">.</span><span class="nx">click</span> <span class="nf">(e) -&gt;</span>
      <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
      <span class="nx">$</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">).</span><span class="nx">scrollTo</span> <span class="nx">$</span><span class="p">((</span><span class="s">&quot;</span><span class="err">#</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nx">$</span><span class="p">.</span><span class="nx">getHash</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;href&quot;</span><span class="p">)))),</span>
        <span class="nv">offset:</span>
          <span class="nv">top: </span><span class="o">-</span><span class="nx">offsetTop</span>

        <span class="nv">duration: </span><span class="mi">800</span>


    <span class="nv">timeWindow = </span><span class="mi">500</span>
    <span class="nv">lastExecution = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">())</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scroll</span> <span class="nf">(e) -&gt;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">lastExecution</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">timeWindow</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">()</span>
        <span class="nv">scrollTop = </span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">+</span> <span class="nx">offsetTop</span> <span class="o">+</span> <span class="nx">screenOffset</span>
        <span class="nx">$anchors</span><span class="p">.</span><span class="nx">removeClass</span> <span class="s">&quot;active&quot;</span>
        <span class="nv">i = </span><span class="mi">0</span>

        <span class="k">while</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">anchorsOffsetsLength</span>
          <span class="nv">j = </span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span>
          <span class="k">if</span> <span class="nx">scrollTop</span> <span class="o">&gt;=</span> <span class="nx">anchorsOffsets</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">anchorsOffsets</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span>
            <span class="nx">$anchors</span><span class="p">.</span><span class="o">not</span><span class="p">(</span><span class="nx">$anchors</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">removeClass</span> <span class="s">&quot;active&quot;</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">$anchors</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">addClass</span> <span class="s">&quot;active&quot;</span>
            <span class="nv">lastExecution = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">())</span>
            <span class="k">return</span>
          <span class="k">else</span> <span class="k">if</span> <span class="nx">scrollTop</span> <span class="o">&gt;=</span> <span class="nx">anchorsOffsets</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">and</span> <span class="nx">scrollTop</span> <span class="o">&lt;</span> <span class="nx">anchorsOffsets</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span>
            <span class="nx">$anchors</span><span class="p">.</span><span class="o">not</span><span class="p">(</span><span class="nx">$anchors</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">removeClass</span> <span class="s">&quot;active&quot;</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">$anchors</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">addClass</span> <span class="s">&quot;active&quot;</span>
            <span class="nv">lastExecution = </span><span class="k">new</span> <span class="nb">Date</span><span class="p">((</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">getTime</span><span class="p">())</span>
            <span class="k">return</span>
          <span class="nx">i</span><span class="o">++</span>

    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span></div></div></div></div></body></html>